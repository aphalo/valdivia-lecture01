<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pedro J. Aphalo">

<title>The light environment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="Qto_light-apps_files/libs/clipboard/clipboard.min.js"></script>
<script src="Qto_light-apps_files/libs/quarto-html/quarto.js"></script>
<script src="Qto_light-apps_files/libs/quarto-html/popper.min.js"></script>
<script src="Qto_light-apps_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Qto_light-apps_files/libs/quarto-html/anchor.min.js"></script>
<link href="Qto_light-apps_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Qto_light-apps_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Qto_light-apps_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Qto_light-apps_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Qto_light-apps_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The light environment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pedro J. Aphalo </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="quantities-and-units-for-light" class="level2">
<h2 class="anchored" data-anchor-id="quantities-and-units-for-light">Quantities and units for light</h2>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="shiny-input-panel">
<div class="shiny-flow-layout">
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="quantity-label" for="quantity">Spectrum expressed as:</label>
<div>
<select id="quantity"><option value="e_irrad" selected="">energy irradiance</option>
<option value="q_irrad">photon irradiance</option>
<option value="illuminance">illuminance</option>
<option value="PAR_q_irrad">PAR photon irraddiance (PPFD)</option>
<option value="PAR_e_irrad">PAR energy irraddiance</option>
<option value="GEN_G_e_irrad">UV GPAS (Caldwell's)</option></select>
<script type="application/json" data-for="quantity" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="light_source-label" for="light_source">Light source:</label>
<div>
<select id="light_source"><option value="sun" selected="">sun</option>
<option value="cloudy">cloudy</option>
<option value="vegetation shade">vegetation shade</option>
<option value="neutral white LED">neutral white LED</option>
<option value="cool white LED">cool white LED</option>
<option value="warm white LED">warm white LED</option>
<option value="grow light broad spectrum">grow light broad spectrum</option>
<option value="R+B LED grow light">R+B LED grow light</option></select>
<script type="application/json" data-for="light_source" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="wl.range0-label" for="wl.range0">Wavelength range (nm)</label>
<input class="js-range-slider" id="wl.range0" data-skin="shiny" data-type="double" data-min="250" data-max="900" data-from="280" data-to="800" data-step="1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-drag-interval="true" data-data-type="number">
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="spctPlot" class="shiny-plot-output" style="width:100%;height:400px;"></div>
</div>
</div>
<div class="cell" data-context="server">

</div>
</section>
<section id="par-in-energy-or-photon-units" class="level2">
<h2 class="anchored" data-anchor-id="par-in-energy-or-photon-units">PAR in energy or photon units</h2>
<p>The definition of PPFD or PAR photon irradiance of McCree assumes equal effectiveness per photon. How does the definition of PAR look like expressed in an energy basis?</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="shiny-input-panel">
<div class="shiny-flow-layout">
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="unit_out-label" for="unit_out">PAR response on:</label>
<div>
<select id="unit_out"><option value="photon" selected="">photon basis </option>
<option value="energy">energy basis </option></select>
<script type="application/json" data-for="unit_out" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="parPlot" class="shiny-plot-output" style="width:100%;height:400px;"></div>
</div>
</div>
<div class="cell" data-context="server">

</div>
</section>
<section id="sunlight-through-a-day" class="level2">
<h2 class="anchored" data-anchor-id="sunlight-through-a-day">Sunlight through a day</h2>
<p>PAR photon irradiance we all know varies through the day. How does the shape of the spectrum vary? We can normalise the spectral irradiance from different times of the day to be 1 at, for example, 550 nm. We can alternatively re-scale the spectra to, for example, 100 umol m<sup>-2</sup> s<sup>-1</sup> of PAR.</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div class="shiny-input-panel">
<div class="shiny-flow-layout">
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="unit_out1-label" for="unit_out1">Spectrum expressed as:</label>
<div>
<select id="unit_out1"><option value="photon" selected="">photon irradiance</option>
<option value="energy">energy irradiance</option></select>
<script type="application/json" data-for="unit_out1" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="norm1-label" for="norm1">Normalised/scaled: </label>
<div>
<select id="norm1"><option value="no" selected="">no</option>
<option value="wl550">1 at 550 nm</option>
<option value="PAR100">PAR 100 umol m-2 s-1 </option></select>
<script type="application/json" data-for="norm1" data-nonempty="">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="wl.range1-label" for="wl.range1">Wavelength range (nm)</label>
<input class="js-range-slider" id="wl.range1" data-skin="shiny" data-type="double" data-min="250" data-max="900" data-from="280" data-to="800" data-step="1" data-grid="true" data-grid-num="10" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-postfix=" nm" data-keyboard="true" data-drag-interval="true" data-data-type="number">
</div>
</div>
<div>
<div class="form-group shiny-input-container">
<label class="control-label" id="spct_idx-label" for="spct_idx">Time of day (sequence)</label>
<input class="js-range-slider" id="spct_idx" data-skin="shiny" data-min="1" data-max="18" data-from="11" data-step="1" data-grid="true" data-grid-num="8.5" data-grid-snap="false" data-prettify-separator="," data-prettify-enabled="true" data-keyboard="true" data-data-type="number">
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="dayPlot" class="shiny-plot-output" style="width:100%;height:400px;"></div>
</div>
</div>
<div class="cell" data-context="server">

</div>
<p>
<script type="application/shiny-prerendered" data-context="server">
library(ggspectra)
library(photobiologyPlants)
library(photobiologySun)
library(photobiologyLamps)
library(photobiologyLEDs)

output$spctPlot <- renderPlot({
    spct <- switch(input[["light_source"]],
                   sun = sun.spct,
                   cloudy = sun.spct,
                   "vegetation shade" = sun.spct,
                   "neutral white LED" = lamps.mspct$Airam.LED.14W.4000K,
                   "cool white LED" = lamps.mspct$V.light.LED.2W.6000K,
                   "warm white LED" = lamps.mspct$Osram.LED.10W.2700K,
                   "grow light broad spectrum" = lamps.mspct$Valoya.LED.B50.AP67.LED.grow.lamp,
                   "R+B LED grow light" = leds.mspct$Epistar_3W_Plant_Grow_LED)
    if (grepl("PAR", input[["quantity"]])) {
      w.band <- PAR()
      plot.w.band <- PAR()
    } else if (grepl("GEN_G", input[["quantity"]])) {
      w.band <- GEN_G()
      plot.w.band <- PAR()
    } else if (input[["quantity"]] == "illuminance") {
      w.band <- ciev2.spct
      plot.w.band <- VIS_bands()
    } else {
      w.band <- waveband(spct)
      plot.w.band <- Plant_bands(std = "sensory10")
    }
    if (grepl("e_", input[["quantity"]])) energy_as_default() else photon_as_default()
    
    z <- spct * w.band
    if (is.waveband(w.band)) {
      z <- interpolate_spct(z, spct$w.length[-nrow(spct)], fill = 0)
    }
    
  autoplot(z, geom = "spct", w.band = plot.w.band,
           range = input[["wl.range0"]], span = 71) +
    theme_bw(15)
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
library(ggspectra)
library(photobiologyWavebands)

output$parPlot <- renderPlot({
  autoplot(PAR(), unit.in = "photon", unit.out = input[["unit_out"]], geom = "spct") +
    theme_bw(15)
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
library(ggspectra)
library(photobiologySun)

sun_hourly_june.mspct <- subset2mspct(sun_hourly_june.spct)[1:18]
sun_hourly_june_norm550.mspct <- normalise(sun_hourly_june.mspct, norm = 550)
sun_hourly_june_PAR1000.mspct <- fscale(sun_hourly_june.mspct, range = PAR(), f = q_irrad, target = 100)
mspct.names <- names(sun_hourly_june.mspct)
output$dayPlot <- renderPlot({
  i <- input[["spct_idx"]]
  mspct <- switch(input[["norm1"]],
                 wl550 = sun_hourly_june_norm550.mspct,
                 PAR100 = sun_hourly_june_PAR1000.mspct,
                 no = sun_hourly_june.mspct)
    autoplot(mspct[c(11, i)], 
           range = input[["wl.range1"]],
           unit.out = input[["unit_out1"]], geom = "spct", norm = "skip",
           ylim = ifelse(input[["norm"]] == "max", c(NA, NA), c(NA, 6))) +
#    ggtitle(mspct.names[1]) +
    theme_bw(15) + theme(legend.position = "top")
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.12.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-javascript"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/ion.rangeSlider.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["strftime"]},{"type":"character","attributes":{},"value":["0.9.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/strftime"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["strftime-min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ionrangeslider-css"]},{"type":"character","attributes":{},"value":["2.3.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/ionrangeslider"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/ion.rangeSlider.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.2"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77]}},"value":[{"type":"character","attributes":{},"value":["assertthat","base","bslib","cachem","cli","colorspace","compiler","datasets","DBI","digest","dplyr","ellipsis","evaluate","fansi","fastmap","generics","ggplot2","ggpmisc","ggpp","ggrepel","ggspectra","glue","graphics","grDevices","grid","gtable","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","lattice","lifecycle","magrittr","MASS","Matrix","MatrixModels","memoise","methods","mime","munsell","photobiology","photobiologyLamps","photobiologyLEDs","photobiologyPlants","photobiologySun","photobiologyWavebands","pillar","pkgconfig","promises","quantreg","R6","Rcpp","rlang","rmarkdown","rstudioapi","sass","scales","shiny","SparseM","splines","stats","stringi","stringr","survival","tibble","tidyselect","tools","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","4.2.1","0.4.0","1.0.6","3.4.1","2.0-3","4.2.1","4.2.1","1.1.3","0.6.30","1.0.10","0.3.2","0.17","1.0.3","1.1.0","0.1.3","3.3.6.9000","0.5.1","0.4.5.9000","0.9.1.9999","0.3.9.9000","1.6.2","4.2.1","4.2.1","4.2.1","0.3.1","0.5.3","1.5.4","1.6.6","0.1.4","1.8.3","1.40","1.3.0","0.20-45","1.0.3","2.0.3","7.3-58.1","1.5-1","0.5-1","2.0.1","4.2.1","0.12","0.5.0","0.10.14.9000","0.5.1","0.5.1","0.4.2","0.4.1","0.5.0","1.8.1","2.0.3","1.2.0.1","5.94","2.5.1","1.0.9","1.0.6","2.17","0.14","0.4.2","1.2.1","1.7.2","1.81","4.2.1","4.2.1","1.7.8","1.4.1","3.3-1","3.1.8","1.2.0","4.2.1","1.2.2","4.2.1","0.5.0","2.5.0","0.34","1.8-4","2.3.6"]}]}]}
</script>
<!--/html_preserve-->
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>